# The Slime King – Game Design Document v4.0 Completo

## 1. Conceito e Visão Geral

### 1.1 Conceito Central

**The Slime King** é um RPG de aventura 2D top-down em pixel art de mundo aberto, com exploração, quebra-cabeças e personalização. O jogador controla um slime branco recém-nascido, que evolui até se tornar o lendário Rei Slime em um mundo de fantasia habitado por criaturas únicas das Montanhas Cristalinas.

### 1.2 Premissa Narrativa

O slime desperta em seu ninho numa caverna escura — ponto de partida para exploração, sobrevivência e autodescoberta. Ao longo da jornada, aprende a formar laços com criaturas fantásticas e desenvolve seu lar cristalino.

### 1.3 Experiência de Jogo

Atmosfera cozy e contemplativa, sem pressão de tempo. O jogador encara desafios repetíveis, ganha recompensas variadas e vivencia um ciclo de crescimento que incentiva a exploração, personalização do lar e interação pacífica com a fauna local.

---

## 2. Gameplay e Mecânicas Principais

### 2.1 Loop Principal de Gameplay

O jogador explora diversas áreas das Montanhas Cristalinas em busca dos cristais elementais, essenciais para o progresso. Esses cristais podem ser encontrados após resolver puzzles, recebidos como recompensa ao completar quests para os habitantes locais (monstros de diversas espécies) ou obtidos como drop de inimigos derrotados. Conforme absorve os fragmentos desses cristais, o Slime libera novas habilidades que aumentam sua capacidade de enfrentar desafios e interagir com o mundo.

### 2.2 Sistema de Evolução

O Slime cresce em tamanho e poder em quatro estágios evolutivos:

- **Filhote:** Estado inicial, movimentação básica
- **Adulto:** Desbloqueia habilidades elementais básicas (4 slots: ZL/L2, L/L1, R/R1, ZR/R2)
- **Grande Slime:** Acesso a combinações elementais avançadas e maior potência
- **Rei Slime:** Maestria completa dos elementos e liderança sobre criaturas

#### Sistema de Habilidades Elementais

As habilidades elementais são ativadas através dos gatilhos e botões dos ombros do controle:

- **Slot 1 (ZL/L2/LT):** Primeira habilidade elemental desbloqueada
- **Slot 2 (L/L1/LB):** Segunda habilidade elemental
- **Slot 3 (R/R1/RB):** Terceira habilidade elemental
- **Slot 4 (ZR/R2/RT):** Quarta habilidade elemental mais poderosa

Cada elemento (Fire, Water, Earth, Air, Nature, Shadow) oferece habilidades únicas que se tornam mais poderosas conforme a evolução do Slime.

### 2.3 Meta Final - Tornar-se o Rei Slime

Para alcançar o título de Rei Slime, o jogador deve cumprir três pré-requisitos importantes:

1. Estar no estágio evolutivo "Grande Slime"
2. Ter desenvolvido significativamente o lar do slime
3. Possuir um grande número de aliados que ampliam sua influência na região

---

## 3. Mundo do Jogo e Ambientação

### 3.1 Lore das Montanhas Cristalinas de Aethros

O universo de The Slime King existe em um mundo profundamente influenciado pelas forças dos espíritos elementais. Onde o poder desses espíritos se concentra, pedras comuns se transformam em raros cristais elementais. Esses cristais não só amplificam as energias naturais da região como também concedem poderes únicos a monstros e plantas, alterando de forma imprevisível o ecossistema das Montanhas Cristalinas. Entre todas as criaturas, apenas o Slime Branco possui a capacidade de absorver e canalizar todos os tipos de essência elementar.

### 3.2 Biomas das Montanhas Cristalinas

#### 3.2.1 Ninho do Slime (Mapa Inicial)

O jogador desperta na caverna aconchegante que serve como lar do Slime Branco. A caverna possui uma iluminação natural suave proporcionada por fendas que permitem a passagem de raios de luz dourada, criando um ambiente quente e calma penumbra. Esse primeiro cenário funcionará como um tutorial natural, guiando o jogador pela saída da caverna e introduzindo os controles básicos do jogo.

### 3.2.2 Floresta Calma - Versão Primavera

Um ambiente florestal caracterizado pela renovação sazonal primaveril. A vegetação apresenta folhagem verde vibrante em diferentes estágios de desenvolvimento, com espécies arbóreas de grande porte estabelecendo um dossel natural.

**Elementos Principais:** Nature, Earth, Air  
**Fragmentos de Cristal:** Verde (Nature), Marrom (Earth), Branco (Air)

**Criaturas:**

- **Cervos-Broto:** Cervídeos com galhos que brotam folhas e flores sazonais
- **Vaga-lumes Síntese:** Besouros bioluminescentes que realizam fotossíntese noturna
- **Ouriços-Semente:** Mamíferos que carregam sementes mágicas nos espinhos
- **Esquilos Coletores:** Roedores organizados que acumulam cristais pequenos
- **Aranhas Tecelãs:** Aracnídeos que tecem teias com fibras vegetais cristalizadas
- **Grilos Musicais:** Insetos que produzem melodias complexas com élitros cristalizados

#### 3.2.3 Lago Espelhado - Cristais do Fundo

Um corpo d'água cristalino que funciona como espelho natural, refletindo com precisão as formações montanhosas circundantes. As águas transparentes permitem visualização clara dos cristais elementais depositados no leito lacustre.

**Criaturas:**

- **Enguias Cristalizadas:** Serpentes aquáticas com escamas cristalinas
- **Águas-vivas Espelhadas:** Cnidários translúcidos que refletem a luz
- **Caracóis Bolha-Cristal:** Moluscos que criam bolhas cristalizadas
- **Lontras Cristalinas:** Mamíferos aquáticos brincalhões com pelagem refletora
- **Libélulas Espelho:** Insetos com asas translúcidas que criam reflexos prismáticos
- **Castores Arquitetos:** Roedores que constroem estruturas elaboradas

#### 3.2.4 Área Rochosa - Montanhas Altas

Uma extensa região montanhosa caracterizada por formações rochosas diversificadas, penhascos imponentes e platôs interconectados.

**Criaturas:**

- **Golems de Pedra:** Construtos de grande porte compostos por rochas e cristais
- **Cobras-Pedra Perfuradoras:** Serpentes que perfuram rochas com cabeças cristalizadas
- **Borboletas Minerais:** Insetos com asas de cristal fragmentado
- **Minhocas Sísmicas:** Vermes gigantes que perfuram rochas causando tremores
- **Lagartos Eco:** Répteis que amplificam sons através de cristas ósseas
- **Besouros Escavadores:** Insetos couraçados que criam túneis precisos

#### 3.2.5 Pântano das Névoas - Vale Inferior

Uma região de baixa altitude caracterizada por solos encharcados e vegetação adaptada à umidade constante. A atmosfera é constantemente envolvida por névoas densas.

**Criaturas:**

- **Libélulas-Névoa:** Insetos gigantes que se materializam e desmaterializam
- **Jacarés-Musgo:** Répteis com dorso coberto de vegetação pantanosa
- **Rãs-Eco:** Anfíbios que amplificam sons através de sacos vocais cristalizados
- **Sanguessugas Purificadoras:** Anelídeos que se alimentam de impurezas
- **Garças Fantasma:** Aves pernaltas semi-etéreas
- **Peixes-Lodo:** Peixes que "nadam" através de lama densa

#### 3.2.6 Câmaras de Lava - Núcleo Vulcânico

Uma região de intensa atividade geotérmica localizada no coração das Montanhas Cristalinas. O ambiente apresenta fluxos de lava ativa, gêiseres de vapor e formações rochosas incandescentes.

**Criaturas:**

- **Escaravelhos-Magma:** Insetos blindados que rolam bolas de lava
- **Salamandras de Fogo:** Anfíbios adaptados que nadam em pools de lava
- **Morcegos-Cinza:** Quirópteros que se alimentam de vapores vulcânicos
- **Lagartixas Vulcânicas:** Répteis pequenos que caminham sobre lava solidificada
- **Libélulas Incandescentes:** Insetos com asas que brilham como brasas
- **Caracóis Obsidiana:** Moluscos com conchas de vidro vulcânico

#### 3.2.7 Pico Nevado - Cume das Montanhas

A região mais elevada das Montanhas Cristalinas, caracterizada por condições climáticas extremas, neve perpétua e formações de gelo cristalino.

**Criaturas:**

- **Corujas-Cristal:** Aves de rapina com penas cristalizadas
- **Lesmas-Neve Gigantes:** Moluscos enormes que se movem lentamente sobre geleiras
- **Raposas-Vento:** Mamíferos que surfam correntes de vento gelado
- **Cabras Cristal:** Caprinos com chifres cristalizados
- **Borboletas Glaciais:** Lepidópteros com asas de gelo
- **Pinguins Ressonantes:** Aves aquáticas com canto cristalino

---

## 4. Sistemas Temporais e Climáticos

### 4.1 Sistema de Dia e Noite

O ciclo dia-noite opera em tempo acelerado, com cada dia completo durando aproximadamente 24 minutos reais (1 minuto real = 1 hora do jogo).

**Fases do Dia:**

- **Madrugada (05:00-06:59):** Período de transição com iluminação suave
- **Manhã (07:00-11:59):** Luz solar plena ativa criaturas diurnas
- **Tarde (12:00-17:59):** Pico de atividade para criaturas diurnas
- **Entardecer (18:00-20:59):** Criaturas crepusculares se tornam ativas
- **Noite (21:00-04:59):** Criaturas noturnas exclusivas aparecem

### 4.2 Sistema de Estações

O ciclo sazonal opera em escala semanal real, com cada estação durando 7 dias reais.

**Estações:**

- **Primavera (Renascimento):** Flores emergem, neve derrete parcialmente
- **Verão (Abundância):** Vegetação máxima, dias mais longos
- **Outono (Transformação):** Folhagem dourada, névoas densas
- **Inverno (Reflexão):** Neve cobre biomas, noites mais longas

### 4.3 Sistema Climático Dinâmico

**Condições Climáticas:**

- **Sol Claro:** Visibilidade máxima, criaturas diurnas ativas
- **Nublado:** Iluminação difusa, criaturas crepusculares ativas durante dia
- **Chuva:** Vegetação cresce temporariamente, cristais de água recarregam
- **Tempestade:** Raios carregam cristais elétricos especiais
- **Neve:** Rastros ficam visíveis mais tempo, cristais de gelo se formam
- **Névoa:** Visibilidade limitada, criaturas fantasma mais ativas

### 4.4 Eventos Temporais Especiais

- **Aurora Cristalina:** Todos os cristais brilham intensamente
- **Eclipse das Névoas:** Névoa especial cobre todos os biomas
- **Tempestade de Cristais:** Cristais pequenos "chovem" do céu

---

## 5. Sistema de Construção e Expansão do Lar

### 5.1 Visão Relaxante

O **Ninho do Slime** evolui organicamente, sem custos ou tempos de espera, apenas pela **amizade com criaturas**.

### 5.2 Áreas de Expansão (4 espaços)

#### 5.2.1 Caverna Principal (inicial)

Estação de descanso com cristais que brilham conforme elementos absorvidos.

#### 5.2.2 Jardim de Cristais

- **Desbloqueio:** Oferecer cristais a Cervos-Broto, Esquilos Coletores e Ouriços-Semente
- **Função:** Gera 1 cristal aleatório por dia
- **Visual:** Canteiros com brotações semelhantes a flores

#### 5.2.3 Lago Interno

- **Desbloqueio:** Ajudar Castores Arquitetos em 5 construções
- **Função:** Cura lenta contínua e respiração subaquática infinita
- **Visual:** Pequena lagoa com vitórias-régias em miniatura

#### 5.2.4 Sótão Panorâmico

- **Desbloqueio:** Seguir Borboletas Minerais por 10 veios de cristal
- **Função:** Previsão de clima para as próximas 2 horas de jogo
- **Visual:** Abertura no teto com cristais suspensos

### 5.3 Visitantes e Vida no Lar

- Criaturas amigas aparecem ocasionalmente dormindo ou brincando
- Duração: 5-10 min por sessão, 1-2 visitas por jogo
- Deixam pequenas memórias visuais (flores, cristais)

---

## 6. Sistema de Inventário Simplificado

### 6.1 Acesso e Interface

- Acesso pelo botão de **Inventário** (Xbox: Vista / PlayStation: Touchpad / Switch: - / Teclado: Tab)
- Tela do inventário com itens organizados em categorias claras

### 6.2 Estrutura de Itens

- **Cristais Elementais:** Coletados para progressão e buffs
- **Itens Consumíveis:** 4 slots disponíveis, consumidos via **D-Pad** (↑→↓← / 1234 no teclado)
- **Itens de Quest ou Especiais:** Para uso ou troca, sem crafting

### 6.3 Características

- Sem sistema de crafting nem armazenamento complexo
- Sem limite rígido no inventário
- Foco em facilitar jogabilidade relaxante

### 6.4 Feedback Visual

- Hotbar visível com 4 consumíveis equipados
- Pequena animação e som indicam consumo
- Destaque para itens recém-adquiridos

---

## 7. Itens Equipáveis

### 7.1 Visão Geral

Itens equipáveis são acessórios que o Slime pode usar para alterar aparência e receber benefícios. Esta mecânica mantém personalização simples e acessível.

### 7.2 Sistema de Equipamento

- O Slime pode equipar **apenas um item por vez**
- Item equipado determina buff ativo e características visuais
- Troca pode ocorrer a qualquer momento via inventário

### 7.3 Aquisição e Progressão

- Itens obtidos por exploração, recompensas, drops ou comércio com NPCs
- Alguns itens exclusivos exigem condições especiais

### 7.4 Interface e Feedback

- Ícone do item equipado visível no HUD
- Buff vigente indicado com efeitos visuais sutis
- Descrição breve ao equipar ou trocar itens

---

## 8. Sistema de Desbloqueio por Contato Repetido

### 8.1 Mecânica

Algumas habilidades especiais são desbloqueadas após contato prolongado ou repetido com determinados estímulos no ambiente. O jogo monitora eventos específicos e acumula "experiência" invisível até atingir limites que desbloqueiam habilidades únicas.

### 8.2 Exemplos de Desbloqueios

- **Caminhante da Chuva:** Após 1 hora cumulativa sob chuva, desbloqueia "Resistência Hídrica"
- **Força do Venenoso:** Após ser envenenado 50 vezes, ganha "Contra-Veneno"
- **Amigo do Cristal:** Após interações repetidas com cristais específicos

### 8.3 Feedback

- Habilidades aparecem destacadas com mensagem e sugestão de uso
- Progresso consultável no menu de habilidades

---

## 9. Sistema de Atributos

### 9.1 Atributos Básicos

| Atributo | Descrição | Aplicação |
|:--|:--|:--|
| Pontos de Vida (PV) | Dano suportado antes de derrota | Slime, inimigos, objetos |
| Defesa | Reduz dano recebido | Slime, inimigos, objetos |
| Ataque Básico | Dano de ataques normais | Slime, inimigos |
| Ataque Especial | Dano de ataques especiais | Slime, inimigos |
| Nível | Progressão do personagem | Slime |

### 9.2 Cálculo de Dano

- Dano Recebido = Máx[(Ataque Atacante – Defesa Alvo), 0]
- Se Dano > 0: subtrai dos PV do alvo

### 9.3 Progressão de Nível (Slime)

- Nível cresce ao coletar energia elemental
- Todos os atributos: valor base × nível atual

### 9.4 Evoluções Visuais

| Nível | Alteração Visual |
|:--:|:--|
| 5 | Sprites maiores e mais detalhados |
| 15 | Ainda maiores, efeitos extras |
| 30 | Máximo detalhamento e tamanho |

---

## 10. Sistema de Combate

### 10.1 Sistema de Tags e Colisões

| Tag | Aplicação | Função |
|:--|:--|:--|
| Player | Slime | Identificação do personagem |
| Destructible | Objetos destrutíveis | Lógica de destruição |
| Enemy | Inimigos | Lógica de combate e drops |
| Attack | Ataques do slime (básicos) | Combate |
| SpecialAttack | Ataques especiais do slime | Combate |

### 10.2 Feedback e Knockback

**Quando causa dano:**

- Visual: impacto, partículas, piscadas
- Auditivo: som de impacto e dano
- Alvo é deslocado para trás proporcional ao dano

**Quando não causa dano:**

- Visual: efeito "bloqueio"
- Auditivo: som de resistência
- Atacante é repelido

**Fórmulas:**

- Knockback alvo: (dano recebido × multiplicador) / peso
- Knockback atacante: (poder de ataque × multiplicador) / peso

---

## 17. Arquitetura Técnica e Sistemas

### 17.1 Estrutura de Estados do Jogo

O jogo opera através de uma máquina de estados centralizada no `GameManager`, com estados claramente definidos:

#### Estados Principais (GameState)

```csharp
public enum GameState
{
    Splash,         // Tela de splash (logos, loading inicial)
    MainMenu,       // Menu principal/tela inicial
    Options,        // Menu de configurações/opções
    Credits,        // Tela de créditos
    Loading,        // Carregando bioma/área de jogo
    Exploring,      // Explorando mundo (estado principal)
    Interacting,    // Dialogando com NPCs/criaturas
    Paused,         // Jogo pausado (menu pause)
    Inventory,      // Menu de inventário aberto
    SkillTree,      // Árvore de habilidades aberta
    Death,          // Slime foi derrotado
    Evolution,      // Processo de evolução do Slime
    Victory         // Área/objetivo completado
}
```

#### Transições Válidas

- **MainMenu** → Options, Credits, Loading
- **Exploring** → Paused, Inventory, SkillTree, Interacting, Death, Evolution, Victory, MainMenu
- **Paused** → Exploring, Options, MainMenu
- **Death** → Exploring (respawn), MainMenu (game over)

### 17.2 Sistema de Elementos Implementado

#### Tipos Elementais (ElementType)

```csharp
public enum ElementType
{
    Fire,       // Fogo - Câmaras de Lava
    Water,      // Água - Lago Espelhado
    Earth,      // Terra - Área Rochosa
    Air,        // Ar - Pico Nevado
    Nature,     // Natureza - Floresta Calma
    Shadow      // Sombra - Pântano das Névoas
}
```

#### Distribuição por Bioma

| Bioma | Elemento Principal | Elementos Secundários |
|:--|:--|:--|
| Floresta Calma | Nature | Earth, Air |
| Lago Espelhado | Water | Air |
| Área Rochosa | Earth | Fire |
| Pântano das Névoas | Shadow | Water, Nature |
| Câmaras de Lava | Fire | Earth |
| Pico Nevado | Air | Water |

### 17.3 Sistema de Progressão do Slime

#### Estágios Evolutivos (SlimeStage)

```csharp
public enum SlimeStage
{
    Filhote,        // Estado inicial
    Adulto,         // Habilidades básicas
    GrandeSlime,    // Combinações avançadas
    ReiSlime        // Maestria completa
}
```

#### Requisitos de Evolução (Configuráveis no GameManager)

- **Filhote → Adulto:** 10 fragmentos totais
- **Adulto → Grande Slime:** 25 fragmentos totais
- **Grande Slime → Rei Slime:** 50 fragmentos totais + 10 aliados

### 17.4 Sistema de Configurações (Revisado)

> Nota (Refatoração Arquitetural): A antiga estrutura `GameSettings` foi removida do `GameManager` em favor de uma separação de responsabilidades. Configurações de áudio serão tratadas por `AudioManager`; gráficos e acessibilidade por um futuro `UISettingsManager`. Abaixo permanece o modelo original apenas como referência histórica (não implementado atualmente).

#### (Obsoleto) GameSettings (Serializable)

```csharp
[System.Serializable]
public class GameSettings
{
    [Header("Audio")]
    public float masterVolume = 1f;
    public float musicVolume = 1f;
    public float sfxVolume = 1f;

    [Header("Graphics")]
    public bool fullscreen = true;
    public int resolutionIndex = 0;
    public bool vSync = true;

    [Header("Gameplay")]
    public bool showTutorials = true;
    public bool showDamageNumbers = true;
    public float uiScale = 1f;

    [Header("Controls")]
    public float mouseSensitivity = 1f;
    public bool invertYAxis = false;

    [Header("Accessibility")]
    public bool subtitles = false;
    public bool colorBlindMode = false;
    public float textSize = 1f;
}
```

### 17.5 Arquitetura de Eventos Desacoplada

#### Categorias de Eventos Implementadas

**GameManagerEvents:** Estados globais do jogo

```csharp
OnGameStateChanged, OnGameStarted, OnGamePaused, OnSlimeEvolved, 
OnLivesChanged, OnCrystalFragmentsChanged, OnFriendshipChanged
```

**PlayerEvents:** Ações do jogador

```csharp
OnPlayerDeath, OnPlayerRespawn, OnPlayerMove, OnPlayerTakeDamage
```

**SlimeEvents:** Sistema de evolução

```csharp
OnCrystalAbsorbed, OnEvolutionTriggered, OnNewAbilityUnlocked
```

**CreatureEvents:** Sistema social

```csharp
OnFriendshipIncreased, OnCreatureBefriended, OnCreatureVisit
```

**BiomeEvents:** Transições de mundo

```csharp
OnBiomeEntered, OnBiomeExited, OnSeasonChanged
```

**UIEvents:** Interface do usuário

```csharp
OnStartGameRequested, OnPauseRequested, OnInventoryOpened
```

### 17.6 Sistema de Atributos do Player

#### PlayerAttributesSystem (Componente modular)

```csharp
// Atributos Base Configuráveis
[SerializeField] private int baseHealthPoints = 10;
[SerializeField] private int baseAttack = 1;
[SerializeField] private int baseDefense = 0;
[SerializeField] private float baseMoveSpeed = 5f;
[SerializeField] private float baseAttackRange = 1f;
[SerializeField] private float baseAttackDuration = 0.5f;
[SerializeField] private float baseAcceleration = 10f;
[SerializeField] private float baseDeceleration = 10f;
```

#### Propriedades Dinâmicas

- **Vida:** Sistema de HP com máximo configurável
- **Ataque/Defesa:** Valores escaláveis com equipamentos
- **Movimento:** Aceleração/desaceleração suaves
- **Combate:** Range e duração de ataques ajustáveis

### 17.7 Sistema de Input Moderno

#### InputManager (Singleton persistente)

Wrapper centralizado para o novo Input System do Unity, com contextos separados:

**Contextos de Input:**

- **UI:** Navegação em menus (Navigate, Submit, Cancel, Point, Click)
- **Gameplay:** Controles de jogo (Move, Attack, Interact, SpecialAttack)
- **System:** Controles globais (Pause, Skip, Quit)

**Benefícios:**

- Desacoplamento total do asset gerado
- Habilitação/desabilitação contextual de mapas
- API limpa para outros sistemas
- Suporte multiplataforma automático

### 17.8 Sistema de Áudio Persistente

#### AudioManager (DontDestroyOnLoad)

```csharp
// Configurações de Volume
[Range(0f, 1f)] private float masterVolume = 1f;
[Range(0f, 1f)] private float musicVolume = 0.7f;
[Range(0f, 1f)] private float sfxVolume = 0.8f;

// Biblioteca de Música
[SerializeField] private AudioClip menuMusic;
[SerializeField] private AudioClip gameplayMusic;
```

**Funcionalidades:**

- Transições suaves com crossfade entre músicas
- Música contínua entre mudanças de cena
- Separação clara entre música e efeitos sonoros
- Controle de volume por categoria

### 17.9 Sistema de Combate Avançado

#### AttackHandler (Detecção retangular otimizada)

```csharp
// Configurações de Ataque
[SerializeField] private Vector2 attackSize = new Vector2(2f, 1.5f);
[SerializeField] private Vector2 attackOffset = Vector2.zero;
[SerializeField] private LayerMask destructableLayerMask = -1;
```

**Características Técnicas:**

- Detecção retangular com `Physics2D.OverlapBox`
- Offset dinâmico baseado na direção do ataque
- Cache de componentes para performance otimizada
- Suporte a objetos destrutíveis (BushDestruct, RockDestruct)
- Sistema de direção automático (Sul/Norte/Leste/Oeste)

### 17.10 Integração Unity 6 + URP

#### Tecnologias Utilizadas

- **Unity 6.3+** com Universal Render Pipeline (URP)
- **Post Processing** para efeitos visuais
- **Cinemachine** para controle de câmera avançado
- **Input System** moderno e multiplataforma
- **Namespace ExtraTools** para organização de código

#### Performance e Otimização

- Object pooling para ataques e efeitos
- Cache de componentes para evitar GetComponent
- WaitForSecondsRealtime cacheado para corrotinas
- Sistema de eventos para reduzir dependências
- Conditional compilation para logs de debug

---

## 18. Sistema de Controles Detalhado

### 18.1 Mapeamento de Controles Completo

#### Input System Moderno (Unity 6)

O jogo utiliza o novo Input System do Unity com suporte completo a múltiplas plataformas e dispositivos de entrada:

**Mapeamento Principal de Controles:**

| Função | Switch | PlayStation | Xbox | GamePad | Keyboard | Descrição |
|:--|:--|:--|:--|:--|:--|:--|
| **Usar habilidade 1** | ZL | L2 | LT | LT | Q | Primeira habilidade elemental |
| **Usar habilidade 2** | L | L1 | LB | LB | E | Segunda habilidade elemental |
| **Usar habilidade 3** | R | R1 | RB | RB | R | Terceira habilidade elemental |
| **Usar habilidade 4** | ZR | R2 | RT | RT | F | Quarta habilidade elemental |
| **Segurar item selecionado** | X | △ (Triângulo) | Y | Y | Left Shift | Mantém item em mãos |
| **Abaixar** | Y | □ (Quadrado) | X | X | Left Ctrl | Esconder/agachar |
| **Ataque / Confirmar** | A | ✕ (X) | A | A | Space | Ataque básico / Confirmar UI |
| **Interagir / Cancelar** | B | ◯ (Círculo) | B | B | Enter | Interação / Voltar em menus |
| **Usar item 1** | ↑ (D-Pad) | ↑ (D-Pad) | ↑ (D-Pad) | ↑ | 1 | Consumível slot 1 |
| **Usar item 2** | → (D-Pad) | → (D-Pad) | → (D-Pad) | → | 2 | Consumível slot 2 |
| **Usar item 3** | ↓ (D-Pad) | ↓ (D-Pad) | ↓ (D-Pad) | ↓ | 3 | Consumível slot 3 |
| **Usar item 4** | ← (D-Pad) | ← (D-Pad) | ← (D-Pad) | ← | 4 | Consumível slot 4 |
| **Abre menu** | + | Options | Menu | Menu | Esc | Menu principal/pausa |
| **Abre inventário** | - | Touchpad | Vista | Select | Tab | Interface de inventário |
| **Movimentação / Navegação** | Stick Esq | Stick Esq | Stick Esq | Stick L | WASD | Movimento/navegação UI |
| **Muda item selecionado** | R3 | R3 | R3 | R3 | Mouse Wheel | Trocar item em mãos |

#### Contextos de Input

**Contexto Gameplay:**

- Todas as funções de movimento, combate e interação
- Habilidades elementais nos gatilhos (L1/L2/R1/R2)
- Itens consumíveis no D-Pad
- Ações contextuais nos botões de ação

**Contexto UI:**

- Navegação com stick esquerdo ou WASD
- Confirmação e cancelamento nos botões de ação
- Abertura de menus com botões de sistema

**Contexto System:**

- Pausa/despause global
- Pular animações (qualquer botão)
- Funções de sistema (sair do jogo)

#### Suporte Multiplataforma Automático

- **PC:** Teclado + Mouse / Gamepad Xbox/PlayStation/Generic
- **Steam Deck:** Controles nativos + touch screen  
- **Xbox Series:** Controles Xbox + UI otimizada
- **Nintendo Switch:** Joy-Con + Pro Controller + touch screen
- **PlayStation:** DualSense + DualShock 4 com mapeamento nativo

#### Características do Novo Esquema

**Ergonomia Melhorada:**

- Habilidades elementais nos gatilhos para acesso rápido durante combate
- Itens consumíveis no D-Pad para uso intuitivo
- Separação clara entre ações de combate e utilitários

**Consistência Multiplataforma:**

- Mapeamento padronizado entre todas as plataformas
- Botões de confirmação/cancelamento seguem convenções de cada console
- Adaptação automática de ícones na UI conforme dispositivo detectado

### 18.2 PlayerController Avançado

#### Características Técnicas

**Movimento Suave:**

```csharp
[SerializeField] private float baseMoveSpeed = 5f;
[SerializeField] private float baseAcceleration = 10f;
[SerializeField] private float baseDeceleration = 10f;
```

**Sistema de Direção Visual:**

- Objetos frontais/traseiros/laterais independentes
- VFX direcionais separados dos sprites principais
- Flip automático para movimentos laterais
- Rotação automática de objetos de ataque

**Estados de Movimento:**

- `_canMove`: Controla se movimento está habilitado
- `_isMoving`: Indica se está em movimento
- `_isAttacking`: Bloqueia movimento durante ataques (opcional)
- `_isHiding`: Estado de agachamento/esconder

**Movimentos Especiais:**

- Sistema de `SpecialMovementPoint` para mecânicas específicas
- Corrotinas gerenciadas para movimentos complexos
- Cache de colliders para otimização

### 18.3 Interface Visual Adaptativa

#### Características da UI

**Estilo Visual:**

- Design cozy com tons suaves e pastéis
- Bordas orgânicas e arredondadas
- HUD minimalista não-intrusivo
- Animações suaves e naturais

**Navegação Universal:**

- Suporte simultâneo: mouse, teclado, gamepad, touch
- Transições contextuais automáticas
- Feedback visual/auditivo consistente
- Escalabilidade de UI configurável

**HUD em Jogo:**

- Vida do slime (visual não-numérico)
- Elemento atualmente selecionado
- Hotbar de consumíveis (4 slots: D-Pad ↑→↓← / Teclado 1234)
- Mini-indicadores de progresso

### 18.4 Sistema de Debug Integrado

#### Ferramentas de Desenvolvimento

**Logs Configuráveis:**

```csharp
[SerializeField] private bool enableDebugLogs = true;
[SerializeField] private bool enableDebugMode = false;
```

**Visualização no Editor:**

```csharp
[SerializeField] private bool enableDebugGizmos = true;
[SerializeField] private bool showDebugGUI = false;
```

**Funcionalidades Debug:**

- Gizmos para ranges de ataque e colisões
- GUI runtime para alteração de valores
- Logs detalhados de estados e transições
- Visualização de áreas de detecção
- Compilação condicional para builds de release

---

## 19. Sistema de Salvamento Técnico

### 19.1 Arquitetura de Dados Persistentes

#### Dados Salvos pelo GameManager

```csharp
// Progressão do Slime
[SerializeField] private SlimeStage currentSlimeStage = SlimeStage.Filhote;
[SerializeField] private int currentLives = 3;
[SerializeField] private float gameTime = 0f;
[SerializeField] private float sessionTime = 0f;
[SerializeField] private string currentBiome = "Ninho";

// Sistema de Cristais
private Dictionary<ElementType, int> crystalFragments;

// Sistema Social
private Dictionary<string, int> friendshipLevels;
private List<string> unlockedHomeExpansions;

// Configurações
private GameSettings gameSettings;
```

### 19.2 Slots de Salvamento

**Estrutura Implementada:**

- **3 Slots Manuais:** Salvamento via menu de pausa
- **1 Slot Automático:** Backup contínuo do progresso

**Pontos de Salvamento Automático:**

- Dormir no ninho do slime
- Transições entre cenas/biomas
- Evolução do slime
- Expansões do lar desbloqueadas
- Marcos importantes de amizade

### 19.3 Dados de Estado Mundial

**Persistência de Objetos:**

- Estado de objetos destrutíveis por cena
- Posições de inimigos derrotados
- Itens coletados permanentemente
- Progresso de puzzles por área

**Sistema de Configurações:**

- Volume master, música e efeitos
- Configurações gráficas (fullscreen, vSync, resolução)
- Configurações de gameplay (tutoriais, números de dano)
- Opções de acessibilidade

---

## 20. Performance e Otimização

### 20.1 Otimizações Implementadas

#### Cache de Componentes

```csharp
// PlayerController - Components
private Rigidbody2D _rigidbody;
private Animator _animator;
private SpriteRenderer _spriteRenderer;
private PlayerAttributesSystem _attributesHandler;

// AttackHandler - Component Cache
private readonly Dictionary<Collider2D, BushDestruct> bushCache;
private readonly Dictionary<Collider2D, RockDestruct> rockCache;
```

#### Object Pooling para Performance

- Pool de objetos de ataque
- Cache de arrays para detecção de colisão
- WaitForSecondsRealtime reutilizáveis
- Strings de hash cacheadas para tags

#### Compilação Condicional

```csharp
[System.Diagnostics.Conditional("UNITY_EDITOR")]
[System.Diagnostics.Conditional("DEVELOPMENT_BUILD")]
private void Log(string message) { /* Logs apenas em debug */ }
```

### 20.2 Métricas de Performance Alvo

**Framerates Alvo:**

- **PC High-end:** 120+ FPS consistente
- **PC Mid-range:** 60 FPS estável
- **Steam Deck:** 60 FPS com configurações otimizadas
- **Consoles:** 60 FPS garantido
- **Nintendo Switch:** 30-60 FPS adaptativo

**Otimizações por Plataforma:**

- Escalabilidade automática de qualidade gráfica
- LOD dinâmico para objetos distantes
- Culling inteligente fora da tela
- Compressão de texturas otimizada por plataforma

---

## 21. Métricas e Analytics

### 21.1 Dados Coletados para Balanceamento

#### Progressão do Jogador

- Tempo total e por sessão (`gameTime`, `sessionTime`)
- Fragmentos coletados por tipo e bioma
- Taxa de mortes por área
- Tempo para cada evolução
- Padrões de movimento e exploração

#### Sistema Social

- Níveis de amizade desenvolvidos
- Tempo gasto com cada criatura
- Taxa de sucesso em interações
- Expansões do lar mais populares

#### Performance do Sistema

- Framerate médio por área
- Tempos de carregamento entre cenas
- Uso de memória por bioma
- Crashes e exceções

### 21.2 Balanceamento Baseado em Dados

**Ajustes Automáticos:**

- Spawn rate de cristais baseado em tempo médio de coleta
- Dificuldade de inimigos baseada em taxa de mortes
- Requisitos de amizade baseados em engajamento médio
- Distribuição de recompensas baseada em padrões de jogo

**Ferramentas de Telemetria:**

- Dashboard de métricas em tempo real (desenvolvimento)
- Heatmaps de movimento dos jogadores
- Gráficos de progressão típica
- Alertas de balanceamento automático

---

## 22. Roadmap de Desenvolvimento Atualizado

### 22.1 Fases de Desenvolvimento Atualizadas

**Estado Atual: Demo Alpha Avançada**

- ✅ Arquitetura base implementada (GameManager, InputManager, AudioManager)
- ✅ Sistema de estados robusto e extensível
- ✅ PlayerController completo com movimento suave
- ✅ Sistema de atributos modular
- ✅ Sistema de combate com detecção retangular
- ✅ Input System moderno implementado
- ✅ Estrutura de eventos desacoplada
- ✅ Sistema de áudio com crossfade
- ✅ Ferramentas de debug integradas

### 22.2 Próximas Etapas Prioritárias

#### Demo Alpha Completação (Q1 2025)

- [ ] Implementar sistema de cristais e absorção
- [ ] Criar sistema de evolução do slime
- [ ] Desenvolver 3 biomas principais funcionais
- [ ] Implementar sistema básico de amizade
- [ ] Sistema de salvamento funcional

#### Demo Beta (Q2 2025)

- [ ] Sistema de estações e clima dinâmico
- [ ] Fauna completa dos 6 biomas
- [ ] Sistema de expansão do lar
- [ ] UI completa e polida
- [ ] Sistema de inventário

#### Demo Next (Q3 2025)

- [ ] Sistema climático avançado
- [ ] Sistema de configurações completo
- [ ] Otimizações de performance
- [ ] Compatibilidade Steam Deck
- [ ] Sistema de achievements

#### V1 Release (Q4 2025)

- [ ] Lançamento PC/Steam completo
- [ ] Multiplayer local implementado
- [ ] Sistema de conquistas
- [ ] Conteúdo pós-lançamento planejado

#### V2 Expansion (Q1 2026)

- [ ] Multiplayer remoto
- [ ] Expansão Xbox Series
- [ ] Novos biomas e criaturas
- [ ] Sistema de temporadas

#### V3 Multi-Platform (Q2 2026)

- [ ] Lançamento Nintendo Switch
- [ ] Lançamento PlayStation
- [ ] Otimizações finais
- [ ] Conteúdo adicional

### 22.3 Dependências Técnicas Identificadas

#### Sistemas Críticos Restantes

1. **Sistema de Cristais:** Base para progressão do slime
2. **IA das Criaturas:** Comportamentos sociais e de combate
3. **Sistema de Biomas:** Transições e características únicas
4. **Quest System:** Missões e objetivos
5. **Sistema de Inventário:** Gerenciamento de itens

#### Ferramentas de Desenvolvimento

1. **Scene Setup Tools:** Automatização de configuração (✅ Implementado)
2. **Asset Pipeline:** Otimização automática de sprites
3. **Build Pipeline:** Configuração multi-plataforma
4. **Testing Framework:** Testes automatizados de gameplay

---

## 23. Conclusões e Considerações Finais

### 23.1 Estado Atual da Implementação

O projeto **The Slime King** demonstra uma arquitetura sólida e bem estruturada, seguindo as boas práticas estabelecidas no documento de diretrizes. A implementação atual revela:

#### Pontos Fortes

- **Arquitetura Limpa:** Separação clara de responsabilidades entre Manager, Controller, Handler e System
- **Desacoplamento:** Sistema de eventos robusto reduz dependências diretas
- **Extensibilidade:** Código preparado para expansões futuras
- **Performance:** Otimizações implementadas desde o início
- **Manutenibilidade:** Código bem documentado e organizado

#### Sistemas Funcionais

- Estado do jogo gerenciado centralmente
- Input System moderno e multiplataforma
- Movimento de personagem suave e responsivo
- Sistema de combate otimizado
- Áudio persistente entre cenas
- Ferramentas de debug integradas

### 23.2 Alinhamento com a Visão Original

A implementação técnica está totalmente alinhada com a visão cozy e contemplativa do jogo:

- **Sem Pressão:** Sistemas que permitem exploração no próprio ritmo
- **Progressão Orgânica:** Evolução baseada em descoberta, não grind
- **Interação Pacífica:** Foco em amizade com criaturas, não combate agressivo
- **Personalização:** Sistema de lar expansível e customizável

### 23.3 Próximos Marcos Críticos

Para manter o cronograma de desenvolvimento, os seguintes sistemas são prioritários:

1. **Sistema de Cristais** (3-4 semanas)
2. **Sistema de Evolução** (2-3 semanas)
3. **Primeiro Bioma Completo** (4-6 semanas)
4. **Sistema de Salvamento** (2-3 semanas)

---

**Status do Documento:** Versão 4.0 Completa - Atualizada com Análise de Código  
**Data:** 7 de outubro de 2025  
**Última Revisão:** Análise completa da implementação atual  
**Próxima Revisão:** Após implementação dos sistemas de cristais e evolução
